{% extends "base.html" %}

{% block title %}Meu Carrinho - Minha Loja{% endblock %}

{% block content %}
<div class="container my-5">
  <h2 class="mb-4">Meu Carrinho de Compras</h2>
  
  {% if carrinho and carrinho.itens.all %}
    <div class="card">
      <table class="table table-hover">
        <thead class="table-dark">
          <tr>
            <th scope="col">Produto</th>
            <th scope="col" class="text-center">Quantidade</th>
            <th scope="col" class="text-end">Preço Unitário</th>
            <th scope="col" class="text-end">Preço Total</th>
          </tr>
        </thead>
        <tbody>
          {% for item in carrinho.itens.all %}
          <tr>
            <td>
              <div class="d-flex align-items-center">
                {% if item.produto.imagem %}
                  <img src="{{ item.produto.imagem.url }}" alt="{{ item.produto.nome }}" style="width: 50px; height: 50px; object-fit: cover; margin-right: 15px;">
                {% endif %}
                <strong>{{ item.produto.nome }}</strong>
              </div>
            </td>
            <td class="text-center">{{ item.quantidade }}</td>
            <td class="text-end">R$ {{ item.produto.preco|floatformat:2 }}</td>
            <td class="text-end">R$ {{ item.get_total|floatformat:2 }}</td>
          </tr>
          {% endfor %}
        </tbody>
        <tfoot class="table-group-divider">
          <tr>
            <td colspan="3" class="text-end"><strong>Total do Carrinho:</strong></td>
            <td class="text-end fs-5"><strong>R$ {{ carrinho.get_total_carrinho|floatformat:2 }}</strong></td>
          </tr>
        </tfoot>
      </table>
    </div>
    <div class="d-flex justify-content-end mt-4">
      <a href="{% url 'pedidos:checkout' %}" class="btn btn-primary btn-lg">Finalizar Compra</a>
    </div>
  {% else %}
    <div class="alert alert-info" role="alert">
      Seu carrinho de compras está vazio. <a href="/" class="alert-link">Comece a comprar!</a>
    </div>
  {% endif %}
</div>
{% endblock %}
